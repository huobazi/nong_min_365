<% errors_count = 0 %> 
<% flash_count = 0 %> 
<% 
    if target && target.errors && target.errors.any?
      errors_count = target.errors.count
end
%>
<% 
    if flash && flash.alert && flash.alert.size > 0
      flash_count = 1  
end
%>

<% all_message_count = errors_count + flash_count %>

<% if all_message_count > 0 %>
  <div class="alert alert-block alert-error">
    <a id="close-flash" class="close" data-dismiss='alert' href="#">×</a>
    <p><strong>有<%= all_message_count %> 处问题导至无法提交:</strong></p>
    <ul>
      <% if errors_count > 0 %>
        <%= content_tag_for(:li,target.errors.full_messages) do |msg| %>
          <%= msg %>
        <% end %>
      <% end %>
      <% if flash_count > 0 %>
        <li><%= flash.alert  %></li>
      <% end %>
    </ul>
  </div>
<% end %>

